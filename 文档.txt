引言----
项目背景：随着工业自动化的发展，RS485 通信在众多领域得到广泛应用。为了确保 RS485 设备之间通信的稳定性和准确性，开发一款 RS485 通信测试软件具有重要的实际意义。

项目目的：本软件旨在提供一个便捷、高效的工具，用于测试 RS485 设备的通信功能，包括数据的发送、接收、错误检测等。

项目范围：本软件主要针对基于 RS485 总线的通信设备进行测试，支持 Modbus 协议，适用于 Windows 操作系统。

术语定义：解释 RS485、Modbus 协议、波特率、校验位等相关术语。

功能需求----
支持串口配置，包括波特率、数据位、停止位、校验位等参数的设置。
能够模拟主站向从站发送请求数据，并接收从站的响应数据。
可实时显示发送和接收的数据信息，包括数据内容、等。
具备数据日志记录功能，可保存发送和接收的数据，支持日志的查看和删除操作。
当出现连接异常或请求无响应时，能及时给出提示信息。
支持定时读取指定设备或全部设备的数据。

非功能需求----
软件界面应简洁直观，易于操作。
具备较高的稳定性和可靠性，能够长时间运行。
响应速度快，数据处理及时准确。

总体设计----
软件架构：采用分层架构设计，分为界面层、业务逻辑层和数据访问层。界面层负责与用户进行交互，显示软件界面；业务逻辑层处理各种业务逻辑，如数据的发送、接收和处理；数据访问层负责与串口进行通信和数据的存储。

详细设计
串口配置模块
功能描述：提供一个界面供用户设置串口的各项参数，如波特率、数据位、停止位、校验位等。
实现细节：使用 C# 的 SerialPort 类来实现串口的配置和打开操作。

数据发送模块
功能描述：根据用户的设置，生成相应的请求数据并通过串口发送给从站。
实现细节：根据 Modbus 协议的规则，构造请求数据帧，使用 SerialPort 类的 Write 方法将数据发送出去。

数据接收模块
功能描述：监听串口的接收事件，当接收到从站的响应数据时，进行解析和处理。
实现细节：使用 SerialPort 类的 DataReceived 事件来监听数据的接收，接收到数据后进行校验和解析。

数据显示模块
功能描述：将发送和接收的数据信息实时显示在界面上，包括数据内容、时间戳等。
实现细节：使用 WPF 的控件（如 ListBox、TextBox 等）来显示数据信息，通过绑定数据模型来实现数据的实时更新。

日志管理模块
功能描述：将发送和接收的数据记录到日志文件中，支持日志的查看和删除操作。
实现细节：使用文件操作来实现日志的记录和读取，通过界面上的按钮来触发日志的查看和删除操作。

异常处理模块
功能描述：处理连接异常、请求无响应等异常情况，给出相应的提示信息。
实现细节：在串口打开、数据发送和接收过程中捕获异常，根据异常类型显示不同的提示信息。

CRC16校验模块
功能描述：处理接收和发送的数据帧的CRC校验。
实现细节：设置了三个相关方法，计算CRC校验数据后添加到报文尾部、整合要发送的的数据帧、验证接收的数据帧。

用户手册----
安装说明：项目基于.NETFramework v4.7.2（WPF/C#）
操作：串口设置可以设置串口所需的信息串口号、波特率、数据位、停止位、校验位。
打开串口会同步获取到串口设置窗体的串口号和表地址信息显示在界面下方。
读取数据是测试能不能正常接收到从站数据，如果从站不返回数据则3秒后显示错误信息。
定时读取用于读取指定设备，设定读取时间，没有收到返回数据会紧发三次请求后自动关闭定时器，设备数据存储是硬编码用的Dictionary键值对容器储存。
读取全部设备，会对所有设备都进行一遍读取，如果从站不返回数据，每个设备会连发送三次请求，都无响应后会自动停止发送。
保存日志是保存在textbox控件显示的操作信息，包含发送报文和接收的报文。
删除日志会清空控件里的内容。

bug情况：有些bug暂时未修复，比如触发定时器关闭后控件没有变化等。

优化建议：无数据返回后继续请求三次的功能模块，使用的是套娃写法，没有优化，可以自行加入心跳包或是异常重连，以及读取数据的方法可以改成异步。

----FIVE-III

